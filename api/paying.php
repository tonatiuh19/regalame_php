<?php
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Methods: GET, POST, PATCH, PUT, DELETE, OPTIONS');
header('Access-Control-Allow-Headers: Origin, Content-Type, X-Auth-Token');
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;
require "./phpmailer/phpmailer/src/Exception.php";
require "./phpmailer/phpmailer/src/PHPMailer.php";
require "./phpmailer/phpmailer/src/SMTP.php";
require_once('db_cnn/cnn.php');
require_once('vendor/autoload.php');
$method = $_SERVER['REQUEST_METHOD'];

if ($method == 'POST') {
    $requestBody = file_get_contents('php://input');
    $params = json_decode($requestBody, true);

    if (isset($params['id_user']) && isset($params['id_extra'])) {
        $id_user = $params['id_user'];
        $id_extra = $params['id_extra'];
        $email_user = $params['email_user'];
        $amount = $params['amount'];
        $description = $params['description'];
        $question_answer = $params['question_answer'];
        $payment_name = $params['payment_name'];
        $note_fan = $params['note_fan'];
        $isPublic_note_fan = $params['isPublic_note_fan'];
        $user_name = $params['user_name'];

        $token = $params['token'];

        $todayVisit = date("Y-m-d H:i:s");

        $stripe = new \Stripe\StripeClient(
            "sk_test_51OtL2vI0AVtzugqlOig4E1ACAVjBX28q4H3PtW5AWEeICiAi6USnIgtDTB4SkQ2cg2FhWReBjT4sVqqNJ321lxHq00ApVEJXcL"
        );

        try {

            $charge = $stripe->charges->create([
                'amount' => $amount * 100,
                'currency' => 'mxn',
                'source' => $token
            ]);
            $chargeId = $charge["id"];

            // Insert into BOOKING table
            $insertExtraPayment = "INSERT INTO payments(id_user, id_extra, email_user, id_stripe, type, status, date, amount, amount_fee, amount_tax, description, question_answer, payment_name, note_fan, isPublic_note_fan) VALUES ('$id_user','$id_extra','$email_user','$chargeId','stripe','Paid','$todayVisit','$amount','','','$description','$question_answer','$payment_name','$note_fan','$isPublic_note_fan')";

            if ($conn->query($insertExtraPayment) === TRUE) {
                $paymentID = $conn->insert_id;

                echo json_encode([
                    "paymentID" => $paymentID,
                    "user_name" => $user_name,
                    "paymentSuccess" => true
                ]);
            } else {
                echo json_encode(["message" => "Error inserting payment: " . $conn->error, "paymentSuccess" => false, "errorCode" => 500]);
            }
        } catch (Exception $e) {
            echo json_encode(["message" => "Error payment: " . $e->getMessage(), "paymentSuccess" => false, "errorCode" => 500]);
        }
    } else {
        echo json_encode(["message" => "Invalid input", "paymentSuccess" => false, "errorCode" => 400]);
    }
} else {
    echo json_encode(["message" => "Invalid request method", "paymentSuccess" => false, "errorCode" => 400]);
}

function sendmailConfirmation($addReplyToEmail, $packID, $packTitle, $packDate, $packPassengers, $packPrice, $packURLTicket, $packInstagramLink, $packTiktokLink, $packFacebookLink)
{
    setlocale(LC_TIME, 'es_ES.UTF-8');
    $date = new DateTime($packDate);
    $formattedDate = strftime('%A %e, de %B, %Y a las %H:%M', $date->getTimestamp());
    $formattedDate = ucfirst($formattedDate);

    $todayVisit = date("Y-m-d");
    $mail = new PHPMailer(true);
    $mess =
        '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="x-apple-disable-message-reformatting"><title></title><style type="text/css">@media only screen and (min-width:620px){.u-row{width:600px!important}.u-row .u-col{vertical-align:top}.u-row .u-col-50{width:300px!important}.u-row .u-col-100{width:600px!important}}@media only screen and (max-width:620px){.u-row-container{max-width:100%!important;padding-left:0!important;padding-right:0!important}.u-row{width:100%!important}.u-row .u-col{display:block!important;width:100%!important;min-width:320px!important;max-width:100%!important}.u-row .u-col>div{margin:0 auto}.u-row .u-col img{max-width:100%!important}.no-stack .u-col{min-width:0!important;display:table-cell!important}.no-stack .u-col-50{width:50%!important}}body{margin:0;padding:0}table,td,tr{vertical-align:top;border-collapse:collapse}p{margin:0}.ie-container table,.mso-container table{table-layout:fixed}*{line-height:inherit}a[x-apple-data-detectors=true]{color:inherit!important;text-decoration:none!important}table,td{color:#000}#u_body a{color:#dcdce0;text-decoration:underline}@media (max-width:480px){#u_content_heading_1 .v-container-padding-padding{padding:40px 51px 10px!important}#u_content_heading_1 .v-font-size{font-size:31px!important}#u_content_heading_1 .v-line-height{line-height:110%!important}#u_content_image_1 .v-container-padding-padding{padding:10px 10px 40px!important}#u_content_image_1 .v-src-width{width:auto!important}#u_content_image_1 .v-src-max-width{max-width:82%!important}#u_content_text_1 .v-container-padding-padding{padding:10px 10px 20px!important}#u_content_text_21 .v-container-padding-padding{padding:10px 10px 20px!important}#u_content_heading_7 .v-container-padding-padding{padding:0 10px!important}#u_content_text_14 .v-container-padding-padding{padding:30px 10px 0!important}#u_content_text_14 .v-text-align{text-align:center!important}#u_content_text_18 .v-container-padding-padding{padding:5px 10px 10px!important}#u_content_text_18 .v-text-align{text-align:center!important}#u_content_heading_8 .v-container-padding-padding{padding:0 10px 30px!important}#u_content_heading_8 .v-text-align{text-align:center!important}#u_content_divider_5 .v-container-padding-padding{padding:0 0 30px!important}#u_content_heading_2 .v-container-padding-padding{padding:30px 10px 0!important}#u_content_heading_2 .v-font-size{font-size:18px!important}#u_content_text_15 .v-container-padding-padding{padding:10px!important}#u_content_text_15 .v-text-align{text-align:center!important}#u_content_button_2 .v-size-width{width:65%!important}#u_content_button_2 .v-container-padding-padding{padding:10px 10px 30px!important}#u_row_12 .v-row-background-image--inner{background-image:url(https://garbrix.com/assets/latinosporeuropa/images/mail-templates/confirmation/discover-more.svg)!important;background-position:center top!important;background-repeat:no-repeat!important}#u_row_12 .v-row-background-image--outer{background-position:center top!important;background-repeat:no-repeat!important}#u_row_12.v-row-background-image--outer{background-position:center top!important;background-repeat:no-repeat!important}#u_content_heading_6 .v-container-padding-padding{padding:33px 151px 0 10px!important}#u_content_heading_6 .v-font-size{font-size:26px!important}#u_content_heading_6 .v-color{color:#22255e!important}#u_content_divider_6 .v-container-padding-padding{padding:10px!important}#u_content_button_1 .v-size-width{width:50%!important}#u_content_button_1 .v-container-padding-padding{padding:10px 10px 47px!important}#u_content_image_9 .v-container-padding-padding{padding:30px 10px 10px!important}#u_content_image_9 .v-src-width{width:auto!important}#u_content_image_9 .v-src-max-width{max-width:25%!important}#u_content_text_19 .v-container-padding-padding{padding:10px 10px 0!important}#u_content_text_19 .v-text-align{text-align:left!important}#u_content_text_20 .v-container-padding-padding{padding:5px 10px 30px!important}#u_content_text_20 .v-text-align{text-align:left!important}#u_content_image_8 .v-container-padding-padding{padding:38px 10px 10px!important}#u_content_image_8 .v-src-width{width:auto!important}#u_content_image_8 .v-src-max-width{max-width:36%!important}#u_content_text_11 .v-container-padding-padding{padding:10px 10px 0!important}#u_content_text_11 .v-text-align{text-align:left!important}#u_content_text_16 .v-container-padding-padding{padding:5px 10px 30px!important}#u_content_text_16 .v-text-align{text-align:left!important}#u_content_social_2 .v-container-padding-padding{padding:30px 10px 10px!important}#u_content_text_deprecated_3 .v-container-padding-padding{padding:30px 10px!important}}</style><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com/css2?family=Epilogue:wght@500&display=swap" rel="stylesheet" type="text/css"></head><body class="clean-body u_body" style="margin:0;padding:0;-webkit-text-size-adjust:100%;background-color:#fff;color:#000"><table id="u_body" style="border-collapse:collapse;table-layout:fixed;border-spacing:0;mso-table-lspace:0;mso-table-rspace:0;vertical-align:top;min-width:320px;margin:0 auto;background-color:#fff;width:100%" cellpadding="0" cellspacing="0"><tbody><tr style="vertical-align:top"><td style="word-break:break-word;border-collapse:collapse!important;vertical-align:top"><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#8abf4e;height:100%;width:100%!important"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent"><table id="u_content_heading_1" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:60px 10px 10px" align="left"><h1 class="v-color v-text-align v-line-height v-font-size" style="margin:0;color:#000;line-height:140%;text-align:center;word-wrap:break-word;font-family:Epilogue;font-size:40px;font-weight:400"><strong>¡Tu pago ha sido procesado exitosamente!</strong></h1></td></tr></tbody></table><table id="u_content_image_1" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 10px 60px" align="left"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="v-text-align" style="padding-right:0;padding-left:0" align="center"><img align="center" border="0" src="https://garbrix.com/assets/latinosporeuropa/images/logo.png" alt="image" title="image" style="outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;clear:both;display:inline-block!important;border:none;height:auto;float:none;width:16%" class="v-src-width v-src-max-width"></td></tr></table></td></tr></tbody></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:0" align="left"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="v-text-align" style="padding-right:0;padding-left:0" align="center"></td></tr></table></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_text_1" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:25px;line-height:140%;text-align:center;word-wrap:break-word"><p style="line-height:140%">Numero de Reserva:</p><p style="line-height:140%"><strong>' . $packID . '</strong></p></div></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#000;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_text_21" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:15px 10px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:25px;color:#fff;line-height:140%;text-align:center;word-wrap:break-word"><p style="line-height:140%"><strong>' . $packTitle . '</strong></p></div></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_heading_7" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:5px 10px" align="left"><h1 class="v-color v-text-align v-line-height v-font-size" style="margin:0;color:#000;line-height:140%;text-align:center;word-wrap:break-word;font-size:22px;font-weight:400"><strong>DETALLES:</strong></h1></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-50" style="max-width:320px;min-width:300px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_text_14" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:30px 10px 0 20px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:16px;color:#000;line-height:140%;text-align:left;word-wrap:break-word"><p style="line-height:140%"><strong>Fecha de reserva: </strong>' . $formattedDate . '</p><p style="line-height:140%"> </p><p style="line-height:140%"><strong>Pasajeros:</strong></p></div></td></tr></tbody></table><table id="u_content_text_18" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:5px 10px 30px 20px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:14px;color:#34495e;line-height:140%;text-align:left;word-wrap:break-word"><ul>';
    foreach ($packPassengers as $passenger) {
        $mess .= '<li style="line-height:19.6px">' . htmlspecialchars($passenger['nombre']) . ' ' . htmlspecialchars($passenger['apellido']) . ', Edad: ' . htmlspecialchars($passenger['edad']) . '</li>';
    }
    $mess .= '</ul></div></td></tr></tbody></table></div></div></div><div class="u-col u-col-50" style="max-width:320px;min-width:300px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_heading_8" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:55px 20px 0 10px" align="left"><h1 class="v-color v-text-align v-line-height v-font-size" style="margin:0;color:#000;line-height:100%;text-align:right;word-wrap:break-word;font-size:24px;font-weight:400"><strong><br><br><br></strong>Precio total:<strong>$' . $packPrice . '<br></strong></h1></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_divider_5" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:0 0 10px" align="left"><table height="0px" align="center" border="0" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;table-layout:fixed;border-spacing:0;mso-table-lspace:0;mso-table-rspace:0;vertical-align:top;border-top:1px solid #bbb;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%"><tbody><tr style="vertical-align:top"><td style="word-break:break-word;border-collapse:collapse!important;vertical-align:top;font-size:0;line-height:0;mso-line-height-rule:exactly;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%"><span>&#160;</span></td></tr></tbody></table></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_heading_2" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:60px 10px 0" align="left"><h1 class="v-color v-text-align v-line-height v-font-size" style="margin:0;color:#000;line-height:140%;text-align:center;word-wrap:break-word;font-size:22px;font-weight:400"><strong>Pagado con Tarjeta Debito/Credito</strong></h1></td></tr></tbody></table><table id="u_content_text_15" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:5px 60px 10px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:14px;color:#34495e;line-height:140%;text-align:center;word-wrap:break-word"><p style="line-height:140%">Pagado seguramente con tarjeta de credito o debito mediante una proteccion de datos segura de 256 bits.</p></div></td></tr></tbody></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:0 0 10px" align="left"><table height="0px" align="center" border="0" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;table-layout:fixed;border-spacing:0;mso-table-lspace:0;mso-table-rspace:0;vertical-align:top;border-top:1px solid #bbb;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%"><tbody><tr style="vertical-align:top"><td style="word-break:break-word;border-collapse:collapse!important;vertical-align:top;font-size:0;line-height:0;mso-line-height-rule:exactly;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%"><span>&#160;</span></td></tr></tbody></table></td></tr></tbody></table><table id="u_content_button_2" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 10px 60px" align="left"><div class="v-text-align" align="center"><a href="' . $packURLTicket . '" target="_blank" class="v-button v-size-width v-font-size" style="box-sizing:border-box;display:inline-block;text-decoration:none;-webkit-text-size-adjust:none;text-align:center;color:#fff;background-color:#8abf4e;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;width:35%;max-width:100%;overflow-wrap:break-word;word-break:break-word;word-wrap:break-word;mso-border-alt:none;font-size:14px"><span class="v-line-height" style="display:block;padding:10px 20px;line-height:120%"><span style="line-height:16.8px">Descargar ticket</span></span></a></div></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row no-stack" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-50" style="max-width:320px;min-width:300px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_image_9" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:60px 10px 10px 20px" align="left"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="v-text-align" style="padding-right:0;padding-left:0" align="left"><img align="left" border="0" src="https://garbrix.com/assets/latinosporeuropa/images/mail-templates/confirmation/image-6.png" alt="image" title="image" style="outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;clear:both;display:inline-block!important;border:none;height:auto;float:none;width:18%;max-width:48.6px" width="48.6" class="v-src-width v-src-max-width"></td></tr></table></td></tr></tbody></table><table id="u_content_text_19" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 10px 0 20px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:16px;color:#22255e;line-height:140%;text-align:left;word-wrap:break-word"><p style="line-height:140%"><strong>Revisa los tramites necesarios</strong></p></div></td></tr></tbody></table><table id="u_content_text_20" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:5px 10px 30px 20px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:14px;color:#34495e;line-height:140%;text-align:left;word-wrap:break-word"><p style="line-height:140%">Revisa todos los documentos necesarios para poder viajar a tu destino. Es importante conocer los requisitos de entrada y salida del pais.</p></div></td></tr></tbody></table></div></div></div><div class="u-col u-col-50" style="max-width:320px;min-width:300px;display:table-cell;vertical-align:top"><div style="background-color:#fff;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_image_8" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:61px 10px 10px 20px" align="left"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="v-text-align" style="padding-right:0;padding-left:0" align="left"><img align="left" border="0" src="https://garbrix.com/assets/latinosporeuropa/images/mail-templates/confirmation/image-7.png" alt="image" title="image" style="outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;clear:both;display:inline-block!important;border:none;height:auto;float:none;width:31%;max-width:83.7px" width="83.7" class="v-src-width v-src-max-width"></td></tr></table></td></tr></tbody></table><table id="u_content_text_11" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 10px 0 20px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:16px;color:#22255e;line-height:140%;text-align:left;word-wrap:break-word"><p style="line-height:140%"><strong>Ponte en contacto con nosotros</strong></p></div></td></tr></tbody></table><table id="u_content_text_16" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:5px 10px 30px 20px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:14px;color:#34495e;line-height:140%;text-align:left;word-wrap:break-word"><p style="line-height:140%">Si tienes alguna duda o pregunta, retraso en tu vuelo o cualquier otra cosa, no dudes en ponerte en contacto con nosotros.</p></div></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="background-color:#b4b7b8;height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_social_2" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:40px 10px 10px" align="left"><div align="center"><div style="display:table;max-width:140px"><table align="center" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width:32px!important;height:32px!important;display:inline-block;border-collapse:collapse;table-layout:fixed;border-spacing:0;mso-table-lspace:0;mso-table-rspace:0;vertical-align:top;margin-right:15px"><tbody><tr style="vertical-align:top"><td align="center" valign="middle" style="word-break:break-word;border-collapse:collapse!important;vertical-align:top"><a href="' . $packInstagramLink . '" title="Instagram" target="_blank"><img src="https://garbrix.com/assets/latinosporeuropa/images/mail-templates/confirmation/image-1.png" alt="Instagram" title="Instagram" width="32" style="outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;clear:both;display:block!important;border:none;height:auto;float:none;max-width:32px!important"></a></td></tr></tbody></table><table align="center" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width:32px!important;height:32px!important;display:inline-block;border-collapse:collapse;table-layout:fixed;border-spacing:0;mso-table-lspace:0;mso-table-rspace:0;vertical-align:top;margin-right:15px"><tbody><tr style="vertical-align:top"><td align="center" valign="middle" style="word-break:break-word;border-collapse:collapse!important;vertical-align:top"><a href="' . $packTiktokLink . '" title="TikTok" target="_blank"><img src="https://garbrix.com/assets/latinosporeuropa/images/mail-templates/confirmation/image-2.png" alt="TikTok" title="TikTok" width="32" style="outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;clear:both;display:block!important;border:none;height:auto;float:none;max-width:32px!important"></a></td></tr></tbody></table><table align="center" border="0" cellspacing="0" cellpadding="0" width="32" height="32" style="width:32px!important;height:32px!important;display:inline-block;border-collapse:collapse;table-layout:fixed;border-spacing:0;mso-table-lspace:0;mso-table-rspace:0;vertical-align:top;margin-right:0"><tbody><tr style="vertical-align:top"><td align="center" valign="middle" style="word-break:break-word;border-collapse:collapse!important;vertical-align:top"><a href="' . $packFacebookLink . '" title="Facebook" target="_blank"><img src="https://garbrix.com/assets/latinosporeuropa/images/mail-templates/confirmation/image-3.png" alt="Facebook" title="Facebook" width="32" style="outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;clear:both;display:block!important;border:none;height:auto;float:none;max-width:32px!important"></a></td></tr></tbody></table></div></div></td></tr></tbody></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:10px 10px 30px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:14px;color:#fff;line-height:140%;text-align:center;word-wrap:break-word"><p style="font-size:14px;line-height:140%">contacto@latinosporeuropa.com </p><p style="font-size:14px;line-height:140%">+12 458 4658</p></div></td></tr></tbody></table></div></div></div></div></div></div><div class="u-row-container v-row-background-image--outer" style="padding:0;background-color:transparent"><div class="u-row" style="margin:0 auto;min-width:320px;max-width:600px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div class="v-row-background-image--inner" style="border-collapse:collapse;display:table;width:100%;height:100%;background-color:transparent"><div class="u-col u-col-100" style="max-width:320px;min-width:600px;display:table-cell;vertical-align:top"><div style="height:100%;width:100%!important;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><div style="box-sizing:border-box;height:100%;padding:0;border-top:0 solid transparent;border-left:0 solid transparent;border-right:0 solid transparent;border-bottom:0 solid transparent;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0"><table id="u_content_text_deprecated_3" role="presentation" cellpadding="0" cellspacing="0" width="100%" border="0"><tbody><tr><td class="v-container-padding-padding" style="overflow-wrap:break-word;word-break:break-word;padding:30px 60px" align="left"><div class="v-color v-text-align v-line-height v-font-size" style="font-size:14px;color:#000;line-height:140%;text-align:center;word-wrap:break-word"><p style="font-size:14px;line-height:140%"><span style="text-decoration:underline;font-size:14px;line-height:19.6px">Terminos, condiciones y aviso de privacidad </span></p></div></td></tr></tbody></table></div></div></div></div></div></div></td></tr></tbody></table></body></html>';

    try {
        //Server settings
        $mail->SMTPDebug = 2; // Enable verbose debug output
        // $mail->isSMTP();                                            // Set mailer to use SMTP
        $mail->Host = "mail.bolsadecafe.com"; // Specify main and backup SMTP servers
        $mail->SMTPAuth = true; // Enable SMTP authentication
        $mail->Username = "dihola@bolsadecafe.com"; // SMTP username
        $mail->Password = "JulioBanda93"; // SMTP password
        $mail->SMTPSecure = "ssl"; // Enable TLS encryption, `ssl` also accepted
        $mail->Port = 469; // TCP port to connect to

        //Recipients
        $mail->setFrom(
            "noreply@latinosporeuropa.com",
            "Pago exitoso - Latinos por Europa"
        );
        $mail->addAddress("" . $addReplyToEmail . "", "Viajero"); // Add a recipient
        //$mail->addCC('cc@example.com');
        //$mail->addBCC('info@agromotics.com', 'Info');

        // Attachments
        //$mail->addAttachment('/var/tmp/file.tar.gz');         // Add attachments
        //$mail->addAttachment('/tmp/image.jpg', 'new.jpg');    // Optional name

        // Content
        $mail->isHTML(true); // Set email format to HTML
        $mail->Subject = "Pago exitoso - Latinos por Europa";
        $mail->Body = $mess;
        $mail->CharSet = 'UTF-8';

        $mail->send();
    } catch (Exception $e) {
        echo "Message could not be sent. Mailer Error: {$mail->ErrorInfo}";
    }
}

$conn->close();
